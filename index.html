<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monitoring Proses Produksi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Mengatur font default dan dark mode (Tema Zinc/Hitam/Putih) */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #18181b; /* Zinc 900 */
            color: #ffffff;
        }
        /* Style untuk kartu menu/navigasi */
        .menu-card {
            background-color: #27272a; /* Zinc 800 */
            transition: all 0.3s ease-in-out;
            cursor: pointer;
            border: 1px solid #3f3f46;
        }
        .menu-card:hover {
            background-color: #3f3f46; /* Zinc 700 */
            transform: translateY(-3px);
            border-color: #22c55e;
        }
        
        /* Style untuk App View */
        .app-view {
            background-color: #18181b; 
            min-height: 100vh;
        }
        
        /* Style Login */
        .login-view {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 1rem;
        }
        .login-card {
            background-color: #27272a;
            border-top: 4px solid #22c55e;
        }
        
        /* Style Tabel */
        .monitor-table {
            background-color: #27272a;
        }
        .monitor-table th {
            background-color: #18181b;
            color: #9ca3af;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        .monitor-table tr:nth-child(even) {
            background-color: #3f3f46;
        }

        /* Style Tombol */
        .btn-primary {
            transition: all 0.2s;
        }
        .btn-primary:hover {
            box-shadow: 0 4px 15px rgba(34, 197, 94, 0.4);
        }

        /* Dashboard Card Specifics (Mirip Gambar Referensi tapi Dark Mode) */
        .process-card {
            background-color: #27272a; /* Zinc 800 */
            border-radius: 0.75rem;
            padding: 1.5rem;
            position: relative;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.5);
            border-top: 4px solid #22c55e; /* Top border hijau */
        }
        /* Chart wrapper agar responsive */
        .chart-wrapper {
            position: relative;
            height: 160px;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 1rem;
            margin-bottom: 1rem;
        }
        .chart-center-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.5rem;
            font-weight: bold;
            color: #ffffff;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }

        /* Input Styles */
        .form-input {
            width: 100%;
            padding: 0.5rem 0.75rem;
            background-color: #3f3f46;
            border: 1px solid #52525b;
            border-radius: 0.5rem;
            color: white;
        }
        .form-input:focus {
            outline: none;
            border-color: #22c55e;
            ring: 2px solid #22c55e;
        }
    </style>
</head>
<body>

    <div id="app-container" class="min-h-screen"></div>

    <script type="module">
        // --- 1. KONFIGURASI DAN STATE ---
        // ID Spreadsheet Baru
        const GOOGLE_SHEET_ID = '1QRlL9YUAjWjQwFlXoEX9SK8hA2DeX6i0BPw3WCEid0w'; 
        // URL Web App Script Baru
        const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbz8WCZcK1zjIm9GsUiA3Dd3ftL6EA6PsdZIKaLtZp7wzDYBq1Fl9hHeLPQsS0JLYgai/exec';
        
        const SHEETS = {
            DASHBOARD: 'dashboardproses', // Nama sheet data proses
            USER: 'Usercontrol',          // Nama sheet login
            LOG: 'LogProduksi'            // Opsional: Jika ada sheet log
        };

        // State Global
        let currentUser = null;
        let dashboardData = [];
        let dashboardHeaders = [];
        let chartInstances = {}; // Menyimpan referensi chart agar bisa di-update/destroy
        let isDataFetched = false;

        // --- 2. FUNGSI UTILITAS (FETCH & PARSE) ---
        
        async function fetchSheetData(sheetName) {
            const url = `https://docs.google.com/spreadsheets/d/${GOOGLE_SHEET_ID}/gviz/tq?tqx=out:json&sheet=${sheetName}`;
            try {
                const response = await fetch(url);
                const text = await response.text();
                // Membersihkan response Google Viz yang diawali "/*O_o*/ google.visualization.Query.setResponse("
                const jsonText = text.substring(text.indexOf('{'), text.lastIndexOf('}') + 1);
                const json = JSON.parse(jsonText);
                
                if (json.status !== 'ok') throw new Error('Error pada query spreadsheet');
                return parseGVizData(json);
            } catch (error) {
                console.error(`Gagal mengambil data sheet ${sheetName}:`, error);
                throw error;
            }
        }

        function parseGVizData(json) {
            const cols = json.table.cols.map(col => (col.label || col.id).toUpperCase().trim());
            const rows = json.table.rows;
            
            const data = rows.map(row => {
                let obj = {};
                cols.forEach((col, index) => {
                    // Ambil nilai formatted (f) jika ada, jika tidak ambil value (v)
                    const cell = row.c[index];
                    obj[col] = cell ? (cell.v !== null ? cell.v : '') : ''; 
                });
                return obj;
            });

            return { headers: cols, data: data };
        }

        // --- 3. NAVIGASI & RENDERING UTAMA ---

        function navigate(page) {
            localStorage.setItem('currentMonitorPage', page);
            
            // Bersihkan chart lama saat pindah halaman
            Object.values(chartInstances).forEach(chart => chart.destroy());
            chartInstances = {};

            const container = document.getElementById('app-container');
            container.innerHTML = ''; // Reset konten

            // Cek Login kecuali halaman login
            if (page !== 'login' && !currentUser) {
                renderLogin();
                return;
            }

            switch (page) {
                case 'login': renderLogin(); break;
                case 'dashboard': renderDashboard(); break;
                case 'kontrolMesin': renderKontrolMesin(); break;
                case 'detailProgress': renderDetailProgress(); break;
                case 'informasi': renderInformasi(); break;
                case 'about': renderAbout(); break;
                default: renderDashboard(); break;
            }
        }

        function createHeader(title, subtitle = '') {
            const username = currentUser ? currentUser.username : 'Guest';
            return `
                <header class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 border-b border-gray-700 pb-4">
                    <div class="flex items-center gap-4">
                        <img src="https://cdn-icons-png.flaticon.com/512/2920/2920349.png" class="h-10 w-10 filter invert" alt="Logo">
                        <div>
                            <h1 class="text-2xl font-bold text-green-500">${title}</h1>
                            <p class="text-sm text-gray-400">${subtitle}</p>
                        </div>
                    </div>
                    <div class="mt-4 md:mt-0 flex items-center gap-3 bg-zinc-800 px-4 py-2 rounded-lg border border-zinc-700">
                        <div class="text-right">
                            <p class="text-xs text-gray-400">Operator</p>
                            <p class="font-bold text-white">${username}</p>
                        </div>
                        <button onclick="handleLogout()" class="p-2 text-red-400 hover:bg-zinc-700 rounded-full transition" title="Logout">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path></svg>
                        </button>
                    </div>
                </header>
            `;
        }

        // --- 4. HALAMAN LOGIN ---
        function renderLogin() {
            const container = document.getElementById('app-container');
            container.innerHTML = `
                <div class="login-view">
                    <div class="login-card w-full max-w-sm p-8 rounded-xl shadow-2xl">
                        <div class="text-center mb-8">
                            <h1 class="text-3xl font-bold text-white mb-2">Monitoring Produksi</h1>
                            <p class="text-gray-400 text-sm">Masuk untuk mengakses dashboard kontrol</p>
                        </div>
                        <form onsubmit="handleLoginSubmit(event)">
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-300 mb-1">Username</label>
                                <input type="text" id="loginUser" class="form-input" placeholder="User ID" required>
                            </div>
                            <div class="mb-6">
                                <label class="block text-sm font-medium text-gray-300 mb-1">Password</label>
                                <input type="password" id="loginPass" class="form-input" placeholder="Password" required>
                            </div>
                            <div id="login-msg" class="hidden mb-4 p-3 bg-red-900/50 text-red-200 text-sm rounded border border-red-800"></div>
                            <button type="submit" id="btn-login" class="w-full btn-primary bg-green-600 text-white px-4 py-3 rounded-lg font-bold hover:bg-green-700">LOGIN</button>
                        </form>
                    </div>
                </div>
            `;
        }

        async function handleLoginSubmit(e) {
            e.preventDefault();
            const btn = document.getElementById('btn-login');
            const msg = document.getElementById('login-msg');
            const userIn = document.getElementById('loginUser').value.trim();
            const passIn = document.getElementById('loginPass').value.trim();

            btn.disabled = true;
            btn.textContent = 'Memverifikasi...';
            msg.classList.add('hidden');

            try {
                const result = await fetchSheetData(SHEETS.USER);
                // Asumsi kolom: USERNAME, PASSWORD, ROLE
                const user = result.data.find(row => 
                    String(row.USERNAME).trim() === userIn && 
                    String(row.PASSWORD).trim() === passIn
                );

                if (user) {
                    currentUser = { username: user.USERNAME, role: user.ROLE || 'Operator' };
                    sessionStorage.setItem('monitorUser', JSON.stringify(currentUser));
                    navigate('dashboard');
                } else {
                    throw new Error('Username atau Password salah');
                }
            } catch (err) {
                msg.textContent = err.message || 'Gagal koneksi ke database.';
                msg.classList.remove('hidden');
                btn.disabled = false;
                btn.textContent = 'LOGIN';
            }
        }

        // --- 5. HALAMAN DASHBOARD (INTI APLIKASI) ---
        async function renderDashboard() {
            const container = document.getElementById('app-container');
            container.innerHTML = `
                <div class="app-view p-6 max-w-7xl mx-auto">
                    ${createHeader('Dashboard Monitor', 'Status Efisiensi dan Output Mesin')}
                    
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                        <button onclick="navigate('dashboard')" class="bg-green-600 text-white p-3 rounded-lg font-bold shadow-lg ring-2 ring-green-400">Dashboard</button>
                        <button onclick="navigate('kontrolMesin')" class="bg-zinc-800 hover:bg-zinc-700 text-gray-300 p-3 rounded-lg font-semibold border border-zinc-700">Kontrol Mesin</button>
                        <button onclick="navigate('detailProgress')" class="bg-zinc-800 hover:bg-zinc-700 text-gray-300 p-3 rounded-lg font-semibold border border-zinc-700">Detail Data</button>
                        <button onclick="navigate('informasi')" class="bg-zinc-800 hover:bg-zinc-700 text-gray-300 p-3 rounded-lg font-semibold border border-zinc-700">Informasi</button>
                    </div>

                    <div id="loading-indicator" class="text-center py-10 text-gray-400 animate-pulse">
                        Mengambil data Live dari Line Produksi...
                    </div>

                    <div id="machine-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
                    
                    <div class="mt-8 text-center">
                        <button onclick="renderDashboard()" class="text-sm text-green-400 hover:text-green-300 underline">Refresh Data</button>
                    </div>
                </div>
            `;

            try {
                const result = await fetchSheetData(SHEETS.DASHBOARD);
                dashboardData = result.data;
                dashboardHeaders = result.headers;
                
                document.getElementById('loading-indicator').classList.add('hidden');
                renderMachineCards(dashboardData);
            } catch (err) {
                document.getElementById('loading-indicator').innerHTML = `<span class="text-red-500">Gagal memuat data: ${err.message}</span>`;
            }
        }

        function renderMachineCards(data) {
            const grid = document.getElementById('machine-grid');
            grid.innerHTML = '';

            data.forEach((row, index) => {
                // Mapping Data (Sesuaikan dengan nama kolom di Sheet Anda jika berbeda)
                // Fallback logic untuk nama kolom
                const namaMesin = row['MESIN'] || row['NAME'] || `Mesin ${index+1}`;
                
                // Parsing Angka
                const qtySelesai = parseFloat(row['QTY SELESAI'] || row['QTY_SELESAI'] || 0);
                const waitProses = parseFloat(row['WAIT PROSES'] || row['WAIT_PROSES'] || 0);
                // Jika sheet punya kolom Target, gunakan. Jika tidak, target = selesai + wait
                const target = parseFloat(row['TARGET'] || (qtySelesai + waitProses)); 
                
                // Hitung Persentase
                let percentage = 0;
                if (target > 0) {
                    percentage = Math.round((qtySelesai / target) * 100);
                }

                // ID Unik untuk Canvas Chart
                const canvasId = `chart-${index}`;

                // Warna Indikator berdasarkan persentase
                let progressColor = '#eab308'; // Default Kuning (seperti gambar)
                if (percentage >= 90) progressColor = '#22c55e'; // Hijau jika excellent
                if (percentage < 30) progressColor = '#ef4444'; // Merah jika rendah

                // HTML Kartu
                const cardHtml = `
                    <div class="process-card hover:bg-zinc-750 transition transform hover:-translate-y-1">
                        <div class="flex justify-between items-center mb-2">
                            <h3 class="text-xl font-bold text-white">${namaMesin}</h3>
                            <span class="text-sm font-mono text-gray-400">${qtySelesai} / ${target}</span>
                        </div>
                        
                        <div class="chart-wrapper">
                            <canvas id="${canvasId}"></canvas>
                            <div class="chart-center-text">${percentage}%</div>
                        </div>

                        <div class="flex justify-between items-end mt-2 text-xs text-gray-400 border-t border-gray-700 pt-2">
                            <div>
                                <p>Qty Selesai</p>
                                <p class="text-lg font-bold text-white">${qtySelesai}</p>
                            </div>
                            <div class="text-right">
                                <p>Wait Proses</p>
                                <p class="text-lg font-bold text-gray-300">${waitProses}</p>
                            </div>
                        </div>
                    </div>
                `;
                grid.innerHTML += cardHtml;

                // Create Chart setelah elemen masuk DOM (gunakan setTimeout agar render UI selesai dulu)
                setTimeout(() => {
                    initChart(canvasId, qtySelesai, (target - qtySelesai), progressColor);
                }, 0);
            });
        }

        function initChart(canvasId, valCompleted, valRemaining, color) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;

            // Pastikan sisa tidak minus (jika over target)
            if (valRemaining < 0) valRemaining = 0;

            chartInstances[canvasId] = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Selesai', 'Sisa'],
                    datasets: [{
                        data: [valCompleted, valRemaining],
                        backgroundColor: [color, '#52525b'], // Warna Progress, Warna Track (Zinc 600)
                        borderWidth: 0,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '75%', // Ketebalan donat
                    plugins: {
                        legend: { display: false },
                        tooltip: { enabled: false } // Matikan tooltip agar bersih seperti dashboard monitor
                    }
                }
            });
        }

        // --- 6. HALAMAN KONTROL MESIN (INPUT DATA) ---
        function renderKontrolMesin() {
            const container = document.getElementById('app-container');
            
            // Ambil daftar mesin dari data dashboard yang sudah di-fetch (cache)
            // Jika belum ada, tampilkan loading/fetch ulang
            let optionsHtml = '<option value="">-- Pilih Mesin --</option>';
            if (dashboardData.length > 0) {
                dashboardData.forEach(row => {
                    const m = row['MESIN'] || row['NAME'];
                    if (m) optionsHtml += `<option value="${m}">${m}</option>`;
                });
            } else {
                fetchSheetData(SHEETS.DASHBOARD).then(res => {
                    dashboardData = res.data;
                    renderKontrolMesin(); // Re-render setelah data ada
                });
                optionsHtml = '<option>Memuat data mesin...</option>';
            }

            container.innerHTML = `
                <div class="app-view p-6 max-w-4xl mx-auto">
                    ${createHeader('Kontrol Mesin', 'Update Status & Output')}
                    <button onclick="navigate('dashboard')" class="mb-6 text-gray-400 hover:text-green-400 flex items-center">
                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
                        Kembali ke Dashboard
                    </button>

                    <div class="bg-zinc-800 p-8 rounded-xl shadow-lg border-l-4 border-blue-500">
                        <form onsubmit="handleSubmitData(event)">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-1">Nama Mesin / Line</label>
                                    <select name="mesin" id="inputMesin" class="form-input" required>
                                        ${optionsHtml}
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-1">Jenis Update</label>
                                    <select name="jenis" class="form-input">
                                        <option value="UPDATE_QTY">Update Qty Selesai</option>
                                        <option value="SET_TARGET">Set Target Baru</option>
                                        <option value="STOP_MESIN">Stop / Downtime</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-1">Nilai / Jumlah</label>
                                    <input type="number" name="nilai" class="form-input" placeholder="0" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-1">Keterangan</label>
                                    <input type="text" name="keterangan" class="form-input" placeholder="Opsional">
                                </div>
                            </div>
                            <div id="form-feedback" class="hidden mb-4 p-3 rounded text-sm text-center font-bold"></div>
                            <button type="submit" id="btn-submit" class="w-full btn-primary bg-blue-600 text-white px-6 py-3 rounded-lg font-bold hover:bg-blue-700">
                                KIRIM UPDATE
                            </button>
                        </form>
                    </div>
                </div>
            `;
        }

        async function handleSubmitData(e) {
            e.preventDefault();
            const form = e.target;
            const btn = document.getElementById('btn-submit');
            const feedback = document.getElementById('form-feedback');
            
            const formData = new FormData(form);
            const payload = {
                action: 'UPDATE_PRODUKSI', // Tag agar Web App Script tahu ini update apa
                mesin: formData.get('mesin'),
                jenis: formData.get('jenis'),
                nilai: formData.get('nilai'),
                keterangan: formData.get('keterangan'),
                user: currentUser.username,
                timestamp: new Date().toISOString()
            };

            btn.disabled = true;
            btn.textContent = 'Mengirim...';
            feedback.classList.add('hidden');

            try {
                // Mengirim data ke Web App Google Script
                // mode: 'no-cors' digunakan karena keterbatasan CORS pada Google Apps Script default
                await fetch(WEB_APP_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                // Karena no-cors, kita tidak bisa baca response. Asumsikan sukses jika tidak error network.
                feedback.textContent = 'Data Berhasil Dikirim!';
                feedback.className = 'mb-4 p-3 rounded text-sm text-center font-bold bg-green-900 text-green-200 block';
                form.reset();
                
                // Clear cache dashboard agar data baru terambil nanti
                dashboardData = []; 

            } catch (err) {
                feedback.textContent = 'Gagal mengirim data. Cek koneksi.';
                feedback.className = 'mb-4 p-3 rounded text-sm text-center font-bold bg-red-900 text-red-200 block';
            } finally {
                btn.disabled = false;
                btn.textContent = 'KIRIM UPDATE';
            }
        }

        // --- 7. HALAMAN DETAIL PROGRESS (TABEL) ---
        async function renderDetailProgress() {
            const container = document.getElementById('app-container');
            container.innerHTML = `
                <div class="app-view p-6 max-w-7xl mx-auto">
                    ${createHeader('Detail Progress', 'Data Mentah Produksi')}
                    <button onclick="navigate('dashboard')" class="mb-4 text-gray-400 hover:text-green-400 flex items-center">
                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg> Kembali
                    </button>
                    <div class="overflow-x-auto shadow-lg rounded-xl">
                        <table class="monitor-table w-full text-left text-sm text-gray-300">
                            <thead class="bg-zinc-900 uppercase text-xs font-bold text-gray-400">
                                <tr id="table-head"></tr>
                            </thead>
                            <tbody id="table-body" class="divide-y divide-zinc-700">
                                <tr><td class="p-4 text-center">Memuat data...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            `;

            try {
                // Selalu fetch fresh data untuk tabel
                const result = await fetchSheetData(SHEETS.DASHBOARD);
                const headers = result.headers;
                const data = result.data;

                const thead = document.getElementById('table-head');
                const tbody = document.getElementById('table-body');

                thead.innerHTML = headers.map(h => `<th class="px-6 py-4 border-b border-zinc-700">${h}</th>`).join('');
                
                if (data.length === 0) {
                    tbody.innerHTML = `<tr><td colspan="${headers.length}" class="p-6 text-center text-gray-500">Data kosong.</td></tr>`;
                    return;
                }

                tbody.innerHTML = data.map(row => `
                    <tr class="hover:bg-zinc-700 transition">
                        ${headers.map(h => `<td class="px-6 py-4 whitespace-nowrap">${row[h]}</td>`).join('')}
                    </tr>
                `).join('');

            } catch (err) {
                document.getElementById('table-body').innerHTML = `<tr><td class="p-4 text-center text-red-500">Gagal: ${err.message}</td></tr>`;
            }
        }

        // --- 8. HALAMAN INFORMASI & ABOUT ---
        function renderInformasi() {
            const container = document.getElementById('app-container');
            container.innerHTML = `
                <div class="app-view p-6 max-w-4xl mx-auto">
                    ${createHeader('Informasi', 'Panduan Operator')}
                    <div class="bg-zinc-800 p-8 rounded-xl shadow-lg text-gray-300 space-y-4">
                        <h3 class="text-xl font-bold text-white">Cara Membaca Dashboard</h3>
                        <ul class="list-disc pl-5 space-y-2">
                            <li><strong>Grafik Donut:</strong> Menunjukkan persentase penyelesaian target hari ini.</li>
                            <li><strong>Warna Kuning:</strong> Proses berjalan normal (Standard).</li>
                            <li><strong>Warna Hijau:</strong> Pencapaian target > 90% (Excellent).</li>
                            <li><strong>Warna Merah:</strong> Pencapaian < 30% atau ada downtime.</li>
                        </ul>
                        <div class="border-t border-gray-700 my-4"></div>
                        <h3 class="text-xl font-bold text-white">Prosedur Update Data</h3>
                        <p>Setiap operator wajib melakukan update data melalui menu "Kontrol Mesin" setiap:</p>
                        <ol class="list-decimal pl-5 space-y-1">
                            <li>Pergantian Shift.</li>
                            <li>Mesin Breakdown/Stop lebih dari 15 menit.</li>
                            <li>Pencapaian output per jam.</li>
                        </ol>
                        <div class="mt-6 text-right">
                             <button onclick="navigate('dashboard')" class="text-green-400 hover:underline">Kembali ke Dashboard</button>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderAbout() {
            const container = document.getElementById('app-container');
            container.innerHTML = `
                <div class="app-view p-6 max-w-4xl mx-auto">
                    ${createHeader('About Aplikasi', 'Versi 1.0')}
                    <div class="bg-zinc-800 p-8 rounded-xl shadow-lg text-center">
                        <img src="https://cdn-icons-png.flaticon.com/512/2920/2920349.png" class="h-20 w-20 mx-auto filter invert mb-4 opacity-50" alt="Logo">
                        <h2 class="text-2xl font-bold text-white mb-2">Monitoring Production System</h2>
                        <p class="text-gray-400 mb-6">Dikembangkan untuk memantau efisiensi (OEE) dan output line produksi secara real-time.</p>
                        
                        <div class="grid grid-cols-2 gap-4 text-left max-w-md mx-auto text-sm bg-zinc-900 p-4 rounded-lg border border-zinc-700">
                            <div class="text-gray-500">Versi</div><div class="text-white">1.0.0 (Beta)</div>
                            <div class="text-gray-500">Database</div><div class="text-white">Google Sheets</div>
                            <div class="text-gray-500">Framework</div><div class="text-white">Tailwind & Vanilla JS</div>
                            <div class="text-gray-500">Developer</div><div class="text-white">IT Support</div>
                        </div>

                         <div class="mt-8">
                             <button onclick="navigate('dashboard')" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">Kembali</button>
                        </div>
                    </div>
                </div>
            `;
        }

        // Global functions
        window.navigate = navigate;
        window.handleLoginSubmit = handleLoginSubmit;
        window.renderDashboard = renderDashboard;
        window.handleSubmitData = handleSubmitData;
        window.handleLogout = () => {
            sessionStorage.removeItem('monitorUser');
            currentUser = null;
            navigate('login');
        };

        // --- INIT ---
        window.onload = () => {
            const storedUser = sessionStorage.getItem('monitorUser');
            if (storedUser) {
                currentUser = JSON.parse(storedUser);
                navigate(localStorage.getItem('currentMonitorPage') || 'dashboard');
            } else {
                navigate('login');
            }
        }
    </script>
</body>
</html>
